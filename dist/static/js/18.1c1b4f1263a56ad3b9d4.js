webpackJsonp([18],{R9Aj:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("Xxa5"),s=r.n(a),l=r("exGp"),m=r.n(l),o=(r("7Nmy"),r("vLgD"));var n=r("TIfe");var c={flag:1},u={flag:2},i={name:"assetSet",components:{},data:function(){return{formItem:{target_name:"",target_teststra:"0",target_starttime:"",target_cycle:"0",target_url:"",target_ip:"",userName:""},strategyRule:[],cycleRule:[],ruleValidate:{assets:[{required:!0,message:"请选择资产",trigger:"change"}],cycle:[{required:!0,message:"请选择周期",trigger:"change"}]}}},created:function(){var t=this.$route.params;this.formItem.assetsUrl=t.assetsUrl,this.formItem.assetsIp=t.assetsIp,this._getRule(c),this._getRule(u)},methods:{_getRule:function(t){var e=this;return m()(s.a.mark(function r(){var a;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,void 0,s=t.flag,Object(o.a)({method:"post",url:"/ZY/task/getRule",data:{flag:s}});case 2:0===(a=r.sent).result&&(1===t.flag?(e.strategyRule=a.rules,e.formItem.strategy=e.strategyRule[0].rule_key):(e.cycleRule=a.rules,e.formItem.cycle=e.cycleRule[0].rule_key));case 4:case"end":return r.stop()}var s},r,e)}))()},timeChange:function(t){this.formItem.target_starttime=t},cancel:function(){},goToIndex:function(t){var e=this;this.$refs[t].validate(function(t){var r,a,s,l,m,c,u,i;t?(e.formItem.userName=Object(n.b)(),(r=e.formItem,a=r.target_name,s=r.target_teststra,l=r.target_cycle,m=r.userName,c=r.target_starttime,u=r.target_url,i=r.target_ip,Object(o.a)({method:"post",url:"/ZY/task/addTask",data:{target_name:a,target_teststra:s,target_cycle:l,userName:m,target_starttime:c,target_url:u,target_ip:i}})).then(function(t){0===t.result?e.$router.push({path:"/taskexecution"}):-1===t.result&&e.$Message.error({content:"添加任务失败"})})):e.$Message.error("Fail!")})}}},f={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"entry"},[r("Form",{ref:"formItem",attrs:{model:t.formItem,"label-width":80,rules:t.ruleValidate}},[r("FormItem",{attrs:{label:"任务名称"}},[r("Input",{attrs:{placeholder:"请输入"},model:{value:t.formItem.target_name,callback:function(e){t.$set(t.formItem,"target_name",e)},expression:"formItem.target_name"}})],1),t._v(" "),r("FormItem",{attrs:{label:"扫描策略"}},[r("Select",{model:{value:t.formItem.target_teststra,callback:function(e){t.$set(t.formItem,"target_teststra",e)},expression:"formItem.target_teststra"}},t._l(t.strategyRule,function(e,a){return r("Option",{key:a,attrs:{value:e.rule_key}},[t._v(t._s(e.rule_name))])}))],1),t._v(" "),"depth"===t.formItem.strategy?[r("FormItem",{attrs:{label:"账号"}},[r("Row",[r("Input",{staticStyle:{width:"420px"},attrs:{placeholder:"请输入您所扫描地址的账号"},model:{value:t.formItem.taskName,callback:function(e){t.$set(t.formItem,"taskName",e)},expression:"formItem.taskName"}})],1)],1),t._v(" "),r("FormItem",{attrs:{label:"密码"}},[r("Row",[r("Input",{staticStyle:{width:"420px"},attrs:{type:"password",placeholder:"请输入您所扫描地址的密码"},model:{value:t.formItem.taskName,callback:function(e){t.$set(t.formItem,"taskName",e)},expression:"formItem.taskName"}})],1)],1)]:t._e(),t._v(" "),r("FormItem",{attrs:{label:"开始时间",prop:"startTime"}},[r("Row",[r("DatePicker",{staticStyle:{width:"420px"},attrs:{type:"datetime",placeholder:"开始时间"},on:{"on-change":t.timeChange}})],1)],1),t._v(" "),r("FormItem",{attrs:{label:"周期",prop:"cycle"}},[r("Select",{model:{value:t.formItem.target_cycle,callback:function(e){t.$set(t.formItem,"target_cycle",e)},expression:"formItem.target_cycle"}},t._l(t.cycleRule,function(e,a){return r("Option",{key:a,attrs:{value:e.rule_key}},[t._v(t._s(e.rule_name))])}))],1),t._v(" "),r("FormItem",{attrs:{label:"资产url"}},[r("Input",{attrs:{placeholder:"请输入"},model:{value:t.formItem.target_url,callback:function(e){t.$set(t.formItem,"target_url",e)},expression:"formItem.target_url"}})],1),t._v(" "),r("FormItem",{attrs:{label:"资产ip"}},[r("Input",{attrs:{placeholder:"请输入"},model:{value:t.formItem.target_ip,callback:function(e){t.$set(t.formItem,"target_ip",e)},expression:"formItem.target_ip"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"info"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),r("Button",{staticStyle:{float:"right"},attrs:{type:"success"},on:{click:function(e){t.goToIndex("formItem")}}},[t._v("提交")])],1)],2)],1)])},staticRenderFns:[]};var g=r("VU/8")(i,f,!1,function(t){r("q66c")},"data-v-4b2247b0",null);e.default=g.exports},q66c:function(t,e){}});