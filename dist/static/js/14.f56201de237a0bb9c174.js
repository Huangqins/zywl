webpackJsonp([14],{"41Qs":function(s,t,a){"use strict";t.a=function(s){var t=s.assets_name,a=s.assets_url,o=s.assets_ip,r=s.assets_network_ports,n=s.assets_network_type,i=s.assets_type,l=s.assets_important,p=s.assets_os_type,d=s.assets_manger,u=s.assets_creatuser,_=s.assets_desc,c=s.assets_detail,m=s.assets_hostname,f=s.assets_numbering;return Object(e.a)({method:"post",url:"/ZY/asset/addAssets",data:{assets_name:t,assets_url:a,assets_ip:o,assets_network_ports:r,assets_network_type:n,assets_type:i,assets_important:l,assets_os_type:p,assets_manger:d,assets_creatuser:u,assets_desc:_,assets_detail:c,assets_hostname:m,assets_numbering:f}})};var e=a("vLgD")},cUtI:function(s,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=a("3cXf"),o=a.n(e),r=a("4YfN"),n=a.n(r),i=a("aA9S"),l=a.n(i),p=a("MsTT"),d=a("sxu/"),u=a("41Qs"),_=a("9rMa"),c=(a("tIHl"),a("7Nmy")),m=a("vLgD");var f=a("TIfe"),h={components:{page:d.a,Modals:p.a},data:function(){var s=this;return{uploadStatus:!1,file:null,loadingStatus:!1,headers:{token:Object(f.a)(),userName:Object(f.b)()},href:"/excel/asset.xlsx",uploadUrl:location.origin+"/ZY/asset/assetsImport",assetAddModal:!1,assetAddLoading:!1,pageLoading:!1,loading:!1,title:"新建",formValidate:!1,width:90,format:[{label:"资产名称",type:"input",prop:"assets_name"},{label:"资产URL",type:"input",prop:"assets_url"},{label:"资产IP",type:"input",prop:"assets_ip"},{label:"端口",type:"input",prop:"assets_port"},{label:"通讯协议",type:"input",prop:"assets_proto"},{label:"开放服务信息",type:"input",prop:"assets_servers"},{label:"所属区域",type:"input",prop:"assets_region"},{label:"资产类型",type:"input",prop:"assets_type"},{label:"资产重要度",type:"input",prop:"assets_important"},{label:"OS类型",type:"input",prop:"assets_os"},{label:"负责人",type:"input",prop:"assets_manger"}],data:{assets_name:"",assets_url:"",assets_ip:"",assets_port:"",assets_proto:"",assets_servers:"",assets_region:"",assets_type:"",assets_important:"",assets_os:"",assets_manger:"",assets_creatuser:""},dataCopy:{},modalStatus:0,footer:!0,rules:{assets_name:[{required:!0,message:"请填写资产名",trigger:"blur"}],assets_url:[{validator:function(t,a,e){a||s.data.assets_ip?e():e(new Error("url或者ip请至少填写一项"))},trigger:"blur"}],assets_ip:[{validator:function(t,a,e){a||s.data.assets_url?e():e(new Error("url或者ip请至少填写一项"))},trigger:"blur"}]},value:"",assets:[{type:"selection",width:60,align:"center"},{title:"资产名称",key:"assets_name",align:"center"},{title:"资产URL",key:"assets_url",align:"center"},{title:"资产IP",key:"assets_ip",align:"center"},{title:"操作",align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small",icon:"edit"},style:{marginRight:"5px"},on:{click:function(){s.data=l()({},s.data,a.row),s.footer=!0,s.modalStatus=0,s.$refs.formValidate.open()}}}),t("Button",{props:{size:"small",icon:"social-buffer"},on:{click:function(){s.dataCopy=l()({},s.data,a.row),s.modalStatus=1,s.footer=!1,s.title="详情",s.$refs.formValidate.open()}}}),t("Button",{props:{type:"error",size:"small",icon:"trash-a"},style:{marginLeft:"5px"},on:{click:function(){s.remove({assets_id:a.row.assets_id})}}})])}}],display:!1,assetsList:[],defaultPage:{area:0,rows:10,page:1},dataTotal:0,params:{}}},computed:n()({},Object(_.b)(["userName"]),{formatType:function(){return 0===this.modalStatus?this.format:this.formatCopy},dataType:function(){return 0===this.modalStatus?this.data:this.dataCopy}}),created:function(){this.params=l()({},this.defaultPage),this._assetsInfo(this.params);var s=JSON.parse(o()(this.format)),t=JSON.parse(o()(this.data));this.dataCopy=l()({},t,{kb_vuln_des:"",kb_vuln_anly:""}),s.forEach(function(s){s.type="div"}),this.formatCopy=s},methods:{handleUpload:function(s){var t=this;return this.file=s,this.$Modal.confirm({content:"您将上传的文件:"+s.name+",是否确定上传?",loading:!0,onOk:function(){t.$refs.upload.post(s),setTimeout(function(){t.$Modal.remove(),t._assetsInfo(t.params)},200)},onCancel:function(){}}),!1},upload:function(){},dataLoad:function(s){this.params=l()({},this.defaultPage,s),this._assetsInfo(this.params)},_assetsInfo:function(s){var t=this;this.pageLoading=!0,Object(c.a)(s).then(function(s){t.assetsList=s.rows,t.dataTotal=s.total,t.pageLoading=!1})},assetsAdd:function(){this.$refs.formValidate.open(),this.data={},this.modalStatus=0},asyncOK:function(s){var t,a,e,o,r,n,i,l,p,d,_,c,f,h,g,y,v=this;s.assets_id?(this.data.assets_creatuser=this.userName,this.loading=!0,(t=s,a=t.assets_id,e=t.assets_name,o=t.assets_url,r=t.assets_ip,n=t.assets_network_ports,i=t.assets_network_type,l=t.assets_type,p=t.assets_important,d=t.assets_os_type,_=t.assets_manger,c=t.assets_creatuser,f=t.assets_desc,h=t.assets_detail,g=t.assets_hostname,y=t.assets_numbering,Object(m.a)({method:"post",url:"/ZY/asset/updateAssets",data:{assets_id:a,assets_name:e,assets_url:o,assets_ip:r,assets_network_ports:n,assets_network_type:i,assets_type:l,assets_important:p,assets_os_type:d,assets_manger:_,assets_creatuser:c,assets_desc:f,assets_detail:h,assets_hostname:g,assets_numbering:y}})).then(function(s){0===s.result?(v._assetsInfo(v.params),v.loading=!1,v.$refs.formValidate.close()):2===s.result&&(v.$Message.warning({content:"资产已存在"}),v.loading=!1)})):(this.data.assets_creatuser=this.userName,this.loading=!0,Object(u.a)(s).then(function(s){0===s.result?(v._assetsInfo(v.params),v.loading=!1,v.$refs.formValidate.close()):2===s.result?(v.$Message.warning({content:"资产已存在"}),v.loading=!1):v.$Message.error({content:"资产添加失败"})}))},remove:function(s){var t,a,e=this;(t=s,a=t.assets_id,Object(m.a)({method:"post",url:"/ZY/asset/assetsDelete",data:{assets_id:a}})).then(function(s){0===s.result&&e._assetsInfo(e.params)})}}},g={render:function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",[a("div",{staticClass:"whole"},[a("section",{staticClass:"assetRight"},[a("div",{staticClass:"assetRight_header"},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"区域",clearable:""},model:{value:s.value,callback:function(t){s.value=t},expression:"value"}}),s._v(" "),a("Button",{attrs:{type:"primary",icon:"ios-search"}},[s._v("搜索")]),s._v(" "),a("Button",{attrs:{type:"primary",icon:"compose"},on:{click:s.assetsAdd}},[s._v("添加")]),s._v(" "),a("Upload",{ref:"upload",staticStyle:{display:"inline-block"},attrs:{multiple:"","show-upload-list":!1,action:s.uploadUrl,"with-credentials":!0,accept:"",name:"excelFile",headers:s.headers,"before-upload":s.handleUpload}},[a("Button",{attrs:{type:"primary",icon:"ios-cloud-upload-outline"}},[s._v("导入")])],1),s._v(" "),a("Button",{attrs:{type:"primary",icon:"log-out"}},[s._v("导出")])],1),s._v(" "),a("div",{staticClass:"assetRight_content"},[a("page",{attrs:{columns:s.assets,data:s.assetsList,dataTotal:s.dataTotal,loading:s.pageLoading},on:{dataLoad:s.dataLoad}})],1)])]),s._v(" "),a("Modals",{ref:"formValidate",attrs:{width:s.width,footer:s.footer,format:s.formatType,data:s.dataType,title:s.title,ruleValidate:s.rules,display:s.display,loading:s.loading},on:{asyncOK:s.asyncOK}})],1)},staticRenderFns:[]};var y=a("vSla")(h,g,!1,function(s){a("nvT3")},"data-v-425b8f22",null);t.default=y.exports},nvT3:function(s,t){}});