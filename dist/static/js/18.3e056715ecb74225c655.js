webpackJsonp([18],{dabu:function(t,e){},edsh:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("3cXf"),n=a.n(l),o=a("4YfN"),i=a.n(o),r=a("aA9S"),s=a.n(r),u=a("MsTT"),d=a("sxu/"),p=a("9rMa"),_=(a("tIHl"),a("vLgD"));var v=a("195I");var c=a("StQU"),b=a("TIfe"),h={4:"紧急风险",3:"高风险",2:"中风险",1:"低风险",0:"无风险"},f={4:"#993333",3:"#DE5145",2:"#FAA732",1:"#23B7E5",0:"#27C24C"},m={components:{Modal:u.a,page:d.a,Modals:u.a,chart:c.a},data:function(){var t=this;return{uploadUrl:location.origin+"/ZY/kb/importExcel",headers:{token:Object(b.a)(),userName:Object(b.b)()},options:{title:{left:"center",textStyle:{color:"#E4E5E5"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{type:"scroll",orient:"vertical",right:5,top:20,bottom:20,data:[],textStyle:{color:"#fbfbfb"}},series:[{type:"pie",radius:"65%",center:["32%","50%"],selectedMode:"single",data:[],label:{formatter:function(t){return t.value}},itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},optionOne:{title:{left:"center",textStyle:{color:"#E4E5E5"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{type:"scroll",orient:"vertical",right:5,top:20,bottom:20,data:[],textStyle:{color:"#fbfbfb"}},label:{formatter:function(t){return t.value}},series:[{type:"pie",radius:"65%",center:["50%","50%"],selectedMode:"single",data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},optionTwo:{title:{left:"center",textStyle:{color:"#E4E5E5"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{type:"scroll",orient:"vertical",right:5,top:20,bottom:20,data:[],textStyle:{color:"#fbfbfb"}},series:[{type:"pie",radius:"65%",center:["50%","50%"],selectedMode:"single",data:[{value:1548,name:"幽州",label:{normal:{rich:{title:{color:"#eee",align:"center"},abg:{backgroundColor:"#333",width:"100%",align:"right",height:25,borderRadius:[4,4,0,0]},weatherHead:{color:"#333",height:24,align:"left"},hr:{borderColor:"#777",width:"100%",borderWidth:.5,height:0},value:{width:20,padding:[0,20,0,30],align:"left"},valueHead:{color:"#333",width:20,padding:[0,20,0,30],align:"center"},rate:{width:40,align:"right",padding:[0,10,0,0]},rateHead:{color:"#333",width:40,align:"center",padding:[0,10,0,0]}}}}},{value:535,name:"跨站脚本"},{value:510,name:"兖州"},{value:634,name:"益州"},{value:735,name:"西凉"}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},footer:!0,pageLoading:!1,loading:!1,title:"新建",formValidate:!1,width:110,format:[{label:"漏洞名称",type:"input",prop:"kb_vuln_name"},{label:"CVE/CNVD编码",type:"input",prop:"kb_vuln_cve"},{label:"漏洞编号",type:"input",prop:"kb_vuln_vnum"},{label:"漏洞级别",type:"input",prop:"kb_vuln_level"},{label:"漏洞端口",type:"input",prop:"kb_vuln_port"},{label:"利用工具",type:"input",prop:"kb_vuln_tool"},{label:"攻击方法",type:"input",prop:"kb_vuln_atme"},{label:"验证手段",type:"input",prop:"kb_vuln_veme"},{label:"攻击Payload",type:"input",prop:"kb_vuln_payload"},{label:"漏洞类型",type:"input",prop:"vuln_type_name"},{label:"漏洞分类",type:"input",prop:"kb_vuln_class"},{label:"风险描述",type:"textarea",prop:"kb_vuln_des"},{label:"修复方案",type:"textarea",prop:"kb_vuln_anly"}],formatCopy:[],data:{kb_vuln_name:"",kb_vuln_cve:"",kb_vuln_vnum:"",kb_vuln_level:"",kb_vuln_port:"",kb_vuln_tool:"",kb_vuln_atme:"",kb_vuln_veme:"",kb_vuln_payload:"",vuln_type_name:"",kb_vuln_class:"",kb_vuln_des:"",kb_vuln_anly:""},dataCopy:{},rules:{kb_vuln_name:[{required:!0,message:"请填写资产名",trigger:"blur"}]},value:"",assets:[{title:"风险编号",key:"kb_vuln_vnum",align:"center"},{title:"风险名称",key:"kb_vuln_name",align:"center"},{title:"CVE/CNVD编码",key:"kb_vuln_cve",align:"center"},{title:"风险级别",key:"kb_vuln_level",align:"center",render:function(t,e){return t("span",""+h[e.row.kb_vuln_level])}},{title:"利用端口",key:"kb_vuln_port",align:"center"},{title:"风险类型",key:"vuln_type_name",align:"center"},{title:"操作",align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"primary",size:"small",icon:"edit"},style:{marginRight:"5px"},on:{click:function(){t.data=s()({},t.data,a.row),t.data.kb_vuln_level=""+h[a.row.kb_vuln_level],t.modalStatus=0,t.footer=!0,t.title="修改",t.$refs.formValidate.open()}}}),e("Button",{props:{type:"error",size:"small",icon:"trash-a"},style:{marginRight:"5px"},on:{click:function(){t._kbDelete(a.row)}}}),e("Button",{props:{size:"small",icon:"social-buffer"},on:{click:function(){t.dataCopy=s()({},t.data,a.row),t.dataCopy.kb_vuln_level=""+h[a.row.kb_vuln_level],t.modalStatus=1,t.footer=!1,t.title="详情",t.$refs.formValidate.open()}}})])}}],display:!1,assetsList:[],defaultPage:{area:1,rows:10,page:1},total:0,params:{},modalStatus:0}},computed:i()({formatType:function(){return 0===this.modalStatus?this.format:this.formatCopy},dataType:function(){return 0===this.modalStatus?this.data:this.dataCopy}},Object(p.b)(["userName"])),mounted:function(){this.vulntype(),this.vulnlevelcount()},created:function(){this.params=s()({},this.defaultPage,{area:0}),this._kbinfo(this.params);var t=JSON.parse(n()(this.format)),e=JSON.parse(n()(this.data));this.dataCopy=s()({},e,{kb_vuln_des:"",kb_vuln_anly:""}),t.forEach(function(t){t.type="div"}),this.formatCopy=t},methods:{assetsAdd:function(){this.footer=!0,this.title="新建",this.modalStatus=0,this.$refs.formValidate.open()},asyncOK:function(t){t.kb_vuln_id?this._kbUpdate(t):this._kbAdd(t)},vulntype:function(){var t=this;this.$refs.firstChart.showLoading(),Object(v.a)({flag:1}).then(function(e){0===e.result&&(t.$refs.firstChart.hideLoading(),e.list.forEach(function(e){t.options.legend.data.push(e.kb_vuln_class),t.options.series[0].data.push({value:e.kb_vuln_vnum,name:e.kb_vuln_class})}))})},vulnlevelcount:function(){var t,e,a=this;this.$refs.secondChart.showLoading(),(t={flag:2},e=t.flag,Object(_.a)({method:"post",url:"/ZY/kb/kbCharts",data:{flag:e}})).then(function(t){0===t.result&&(t.list.forEach(function(t){a.optionOne.legend.data.push(h[t.kb_vuln_level]),a.optionOne.series[0].data.push({value:t.kb_vuln_vnum,name:h[t.kb_vuln_level],itemStyle:{color:f[t.kb_vuln_level]}})}),a.$refs.secondChart.hideLoading())})},_kbAdd:function(t){var e,a,l,n,o,i,r,s=this;this.loading=!0,(e=t,a=e.kb_vuln_name,l=e.kb_vuln_cve,n=e.kb_vuln_vnum,o=e.kb_vuln_level,i=e.kb_vuln_port,r=e.kb_vuln_type,Object(_.a)({method:"post",url:"ZY/kb/addKB",data:{kb_vuln_name:a,kb_vuln_cve:l,kb_vuln_vnum:n,kb_vuln_level:o,kb_vuln_port:i,kb_vuln_type:r}})).then(function(t){0===t.result?(s.$refs.formValidate.close(),s._kbinfo(s.params),s.loading=!1):s.$refs.formValidate.open()})},_kbUpdate:function(t){var e,a,l,n,o,i,r,s,u=this;(e=t,a=e.kb_vuln_id,l=e.kb_vuln_name,n=e.kb_vuln_cve,o=e.kb_vuln_vnum,i=e.kb_vuln_level,r=e.kb_vuln_port,s=e.kb_vuln_type,Object(_.a)({method:"post",url:"ZY/kb/updateKB",data:{kb_vuln_id:a,kb_vuln_name:l,kb_vuln_cve:n,kb_vuln_vnum:o,kb_vuln_level:i,kb_vuln_port:r,kb_vuln_type:s}})).then(function(t){0===t.result?(u.$refs.formValidate.close(),u._kbinfo(u.params)):-1===t.result&&(u.$Notice.error({title:"返回信息",desc:"修改失败",duration:2}),u.$refs.formValidate.open())})},_kbDelete:function(t){var e,a,l=this;(e=t,a=e.kb_vuln_id,Object(_.a)({method:"post",url:"/ZY/kb/deleteKB",data:{kb_vuln_id:a}})).then(function(t){0===t.result&&l._kbinfo(l.params)})},_kbinfo:function(t){var e,a,l,n,o=this;this.pageLoading=!0,(e=t,a=e.userName,l=e.rows,n=e.page,Object(_.a)({url:"/ZY/kb/KBInfo",method:"post",data:{userName:a,rows:l,page:n}})).then(function(t){0===t.result&&(o.assetsList=t.rows,o.total=t.total,o.pageLoading=!1)})},dataLoad:function(t){this.params=s()({},this.defaultPage,t),this._kbinfo(this.params)}}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"whole"},[a("section",{staticClass:"assetRight"},[a("div",{staticClass:"assetRight_header"},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"区域",clearable:""},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t._v(" "),a("Button",{attrs:{type:"primary",icon:"ios-search"}},[t._v("搜索")]),t._v(" "),a("Button",{attrs:{type:"primary",icon:"compose"},on:{click:t.assetsAdd}},[t._v("添加")]),t._v(" "),a("Upload",{staticStyle:{display:"inline-block"},attrs:{multiple:"",action:t.uploadUrl,"with-credentials":!0,name:"excelFile",headers:t.headers,"show-upload-list":!1}},[a("Button",{attrs:{type:"primary",icon:"ios-cloud-upload-outline"}},[t._v("导入")])],1),t._v(" "),a("Button",{attrs:{type:"primary",icon:"log-out"}},[t._v("导出")])],1),t._v(" "),a("div",{staticClass:"assetRight_pro"},[a("section",[a("chart",{ref:"firstChart",attrs:{width:"500px",height:"260px",option:t.options}})],1),t._v(" "),a("section",[a("chart",{ref:"secondChart",attrs:{width:"440px",height:"260px",option:t.optionOne,id:"optionOne"}})],1),t._v(" "),a("section")]),t._v(" "),a("div",{staticClass:"assetRight_content"},[a("page",{attrs:{columns:t.assets,data:t.assetsList,dataTotal:t.total,loading:t.pageLoading},on:{dataLoad:t.dataLoad}})],1)])]),t._v(" "),a("Modals",{ref:"formValidate",attrs:{width:t.width,format:t.formatType,data:t.dataType,title:t.title,rules:t.rules,display:t.display,loading:t.loading,footer:t.footer},on:{asyncOK:t.asyncOK}})],1)},staticRenderFns:[]};var g=a("vSla")(m,k,!1,function(t){a("dabu")},"data-v-9c940134",null);e.default=g.exports}});